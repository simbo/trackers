!function e(t,r,n){function o(c,a){if(!r[c]){if(!t[c]){var s="function"==typeof require&&require;if(!a&&s)return s(c,!0);if(i)return i(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[c]={exports:{}};t[c][0].call(d.exports,function(e){var r=t[c][1][e];return o(r?r:e)},d,d.exports,e,t,r,n)}return r[c].exports}for(var i="function"==typeof require&&require,c=0;c<n.length;c++)o(n[c]);return o}({1:[function(e,t,r){"use strict";function n(e,t){var r=0,n={};if(!(e.wrap instanceof HTMLDivElement))throw new Error("invalid container");if(!(e.list instanceof HTMLUListElement))throw new Error("invalid list");if("string"!=typeof t)throw new Error("invalid template");if(!s)throw new Error("localStorage not available");o(this,{trackers:{get:function(){return n}},minified:{get:function(){return Object.keys(n).reduce(function(e,t){return e.concat([n[t].minified])},[])}},mergeMode:{get:function(){return/(^|\ )trackers-merge-mode(\ |$)/i.test(e.wrap.className)}},deleteMode:{get:function(){return/(^|\ )trackers-delete-mode(\ |$)/i.test(e.wrap.className)}}}),this.add=function(o,i){var s,u=r++;return i="boolean"==typeof i?i:!0,o=n[u]=o instanceof a?o:new a,s=c(t,{tracked:o.format(),description:o.description,tracking:o.tracking,id:u}),e.list.insertBefore(s,e.list.firstChild),this.addTrackerEvents(o,u,{container:s,tracked:s.querySelector(".tracker-tracked"),description:s.querySelector(".tracker-description"),toggle:s.querySelector(".tracker-toggle"),merge:s.querySelector(".tracker-merge"),remove:s.querySelector(".tracker-remove")}),i&&this.store(),this},this.remove=function(t,r){return r="boolean"==typeof r?r:!0,n.hasOwnProperty(t)&&(delete n[t],e.list.removeChild(document.getElementById("tracker-"+t)),r&&this.store()),this},this.enableMergeMode=function(){this.disableDeleteMode(),e.wrap.className+=" trackers-merge-mode"},this.disableMergeMode=function(){e.wrap.className=e.wrap.className.replace(/(^|\ )trackers-merge-mode(\ |$)/gi,"$2")},this.enableDeleteMode=function(){this.disableMergeMode(),e.wrap.className+=" trackers-delete-mode"},this.disableDeleteMode=function(){e.wrap.className=e.wrap.className.replace(/(^|\ )trackers-delete-mode(\ |$)/gi,"$2")},this["new"]=function(){var e=r;this.add(),n[e].start(),document.getElementById("tracker-"+e).querySelector(".tracker-description").focus()}.bind(this)}var o=e("functions/define-properties"),i=e("functions/on-value-update"),c=e("functions/render-template"),a=e("classes/tracker"),s=window.localStorage;n.prototype.store=function(){try{s.setItem("trackers",JSON.stringify(this.minified))}catch(e){throw new Error("could not store trackers")}return this},n.prototype.restore=function(){try{Object.keys(this.trackers).forEach(function(e){this.remove(e)}.bind(this)),(JSON.parse(s.getItem("trackers"))||[]).forEach(function(e){e.unshift(null),this.add(new(Function.prototype.bind.apply(a,e)),!1)}.bind(this))}catch(e){throw new Error("could not restore trackers")}return this},n.prototype.removeAll=function(){return Object.keys(this.trackers).forEach(function(e){this.remove(e,!1)}.bind(this)),this.store(),this},n.prototype.mergeSelected=function(){return this},n.prototype.toggleMergeMode=function(){return this.mergeMode?this.disableMergeMode():this.enableMergeMode(),this},n.prototype.toggleDeleteMode=function(){return this.deleteMode?this.disableDeleteMode():this.enableDeleteMode(),this},n.prototype.addTrackerEvents=function(e,t,r){function n(){r.container.className=r.container.className.replace(/(^|\ )tracker--(not-)?tracking(\ |$)/gi,"$3"),r.container.className+=" tracker--"+(e.tracking?"":"not-")+"tracking"}function o(){u&&clearInterval(u),u=window.setInterval(function(){r.tracked!==document.activeElement&&(r.tracked.value=e.format())})}function c(){clearInterval(u)}function s(){r.description.style.height="auto",r.description.style.height=r.description.scrollHeight+"px"}var u;return i(r.description,function(){e.description=r.description.value,s(),this.store()}.bind(this)),i(r.tracked,function(){e.tracked=a.stringToDuration(r.tracked.value),e.tracking&&(e.trackingSince=a.now()),this.store()}.bind(this)),r.tracked.addEventListener("blur",function(){r.tracked.value=e.format()}),r.toggle.addEventListener("click",function(){e.toggle(),this.store()}.bind(this)),r.remove.addEventListener("click",function(){this.remove(t)}.bind(this)),r.merge.addEventListener("click",function(){r.container.className+=" tracker-merge-select"}),e.on("start",function(){Object.keys(this.trackers).forEach(function(t){this.trackers[t]!==e&&this.trackers[t].stop()}.bind(this)),o(),n(),s()}.bind(this)),e.on("stop",function(){c(),n(),s()}),e.tracking&&o(),s(),this},t.exports=n},{"classes/tracker":2,"functions/define-properties":3,"functions/on-value-update":5,"functions/render-template":6}],2:[function(e,t,r){"use strict";function n(e,t,r){var i={tracked:0,tracking:!1,description:""},c={};o(this,{tracked:{get:function(){return i.tracked},set:function(e){"undefined"!=typeof e&&(i.tracked=n.durationToNumber(n.anyToDuration(e)))}},trackedTotal:{get:function(){return this.tracking?i.tracked+n.now()-i.tracking:this.tracked}},tracking:{get:function(){return i.tracking!==!1},set:function(e){"boolean"==typeof e?(i.tracked=this.trackedTotal,e?i.tracking=n.now():i.tracking=!1):"undefined"!=typeof e&&(i.tracking=n.now()-n.durationToNumber(n.anyToDuration()))}},trackingSince:{get:function(){return this.tracking?i.tracking:void 0},set:function(e){"undefined"!=typeof e&&(e=parseInt(e,10),isNaN(e)||(i.tracking=e))}},description:{get:function(){return i.description},set:function(e){"string"==typeof e&&(e=e.trim()).length>0&&(i.description=e)}},minified:{get:function(){return[i.tracked,i.tracking,i.description]}}}),this.merge=function(e){return e instanceof n&&(i.tracked+=n.durationToNumber(e.trackedTotal),i.description+="\n"+e.descroption),this},this.on=function(e,t){"function"==typeof t&&(c[e]=t)},this.trigger=function(e){c.hasOwnProperty(e)&&c[e]()},this.tracked=e,this.trackingSince=t,this.description=r}var o=e("functions/define-properties");n.prototype.start=function(){return this.tracking=!0,this.trigger("start"),this},n.prototype.stop=function(){return this.tracking=!1,this.trigger("stop"),this},n.prototype.toggle=function(){this.tracking?this.stop():this.start()},n.prototype.format=function(e,t){return e="string"==typeof e?e:"%h:%m:%s",t="undefined"!=typeof t?n.anyToDuration(t):n.numberToDuration(this.trackedTotal),Object.keys(t).reverse().reduce(function(e,r){return e.replace(new RegExp("%"+r,"ig"),("0"+t[r]).slice(-2))},e)},n.now=function(){return(new Date).getTime()},n.numberToDuration=function(e){return{h:Math.floor(e/36e5),m:Math.floor(e/6e4%60),s:Math.floor(e/1e3%60),ms:Math.floor(e%1e3)}},n.stringToDuration=function(e){return n.arrayToDuration(("string"==typeof e?e:e.toString()||"").replace(/[^0-9:]/g,"").split(":"))},n.arrayToDuration=function(e){return["h","m","s","ms"].reduce(function(t,r,n){var o=parseInt(e[n],10);return t[r]=isNaN(o)?0:o,t},{})},n.durationToNumber=function(e){var t=0;return e.hasOwnProperty("h")&&(t+=60*parseInt(e.h,10)*60*1e3),e.hasOwnProperty("m")&&(t+=60*parseInt(e.m,10)*1e3),e.hasOwnProperty("s")&&(t+=1e3*parseInt(e.s,10)),e.hasOwnProperty("ms")&&(t+=parseInt(e.ms,10)),t},n.anyToDuration=function(e){if("number"==typeof e&&!isNaN(e))return n.numberToDuration(e);if(Array.isArray(e))return n.arrayToDuration(e);if("string"==typeof e)return n.stringToDuration(e);if("object"==typeof e)return n.numberToDuration(n.durationToNumber(e));throw new Error("unexpected duration type: "+typeof e)},t.exports=n},{"functions/define-properties":3}],3:[function(e,t,r){"use strict";function n(e,t,r){if("object"!=typeof e)throw new Error("no valid object to add properties");if("object"!=typeof t)throw new Error("no valid definitions object");r="object"==typeof r?r:{get:o,set:o,enumerable:!0},Object.defineProperties(e,Object.keys(t).reduce(function(e,n){return e[n]=Object.keys(r).reduce(function(e,t){return e.hasOwnProperty(t)||(e[t]=r[t]),e},t[n]),e},{}))}function o(){}t.exports=n,t.exports.noop=o},{}],4:[function(e,t,r){"use strict";function n(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}t.exports=n},{}],5:[function(e,t,r){"use strict";function n(e,t){function r(e){window.setTimeout(function(){t(e)},0)}e.addEventListener("change",t),e.addEventListener("cut",r),e.addEventListener("paste",r),e.addEventListener("drop",r),e.addEventListener("keydown",r)}t.exports=n},{}],6:[function(e,t,r){"use strict";function n(e,t){var r=document.implementation.createHTMLDocument(),n=o[e]=o[e]||new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("{%").join("	").replace(/((^|%\})[^\t]*)"/g,"$1\r").replace(/\t=(.*?)%\}/g,"',$1,'").split("	").join("');").split("%}").join("p.push('").split("\r").join('"')+'\');}return p.join("");');return t="object"==typeof t?t:{},r.body.innerHTML=n(t),r.body.children.length>1?r.body.children:r.body.children[0]}var o={};t.exports=n},{}],7:[function(e,t,r){"use strict";var n,o=e("functions/on-dom-ready"),i=e("classes/tracker-collection");o(function(){n=new i({wrap:document.getElementById("trackers-wrap"),list:document.getElementById("trackers-list")},document.getElementById("tracker-template").innerHTML),n.restore(),[["trackers-button--add",n["new"]],["trackers-button--delete",n.toggleDeleteMode],["trackers-button--rem-all",n.removeAll],["trackers-button--cancel-del",n.disableDeleteMode],["trackers-button--merge",n.toggleMergeMode],["trackers-button--merge-sel",n.mergeSelected],["trackers-button--cancel-merge",n.disableMergeMode]].forEach(function(e){document.getElementById(e[0]).addEventListener("click",e[1].bind(n))})})},{"classes/tracker-collection":1,"functions/on-dom-ready":4}]},{},[7]);
//# sourceMappingURL=main.0-2-0.js.map