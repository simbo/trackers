!function t(e,r,n){function i(c,a){if(!r[c]){if(!e[c]){var s="function"==typeof require&&require;if(!a&&s)return s(c,!0);if(o)return o(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[c]={exports:{}};e[c][0].call(d.exports,function(t){var r=e[c][1][t];return i(r?r:t)},d,d.exports,t,e,r,n)}return r[c].exports}for(var o="function"==typeof require&&require,c=0;c<n.length;c++)i(n[c]);return i}({1:[function(t,e,r){"use strict";function n(t,e){var r=0,n={};if(!(t.wrap instanceof HTMLDivElement))throw new Error("invalid container");if(!(t.list instanceof HTMLUListElement))throw new Error("invalid list");if(!(t.add instanceof HTMLButtonElement))throw new Error("invalid button");if(!(t.merge instanceof HTMLButtonElement))throw new Error("invalid button");if(!(t["delete"]instanceof HTMLButtonElement))throw new Error("invalid button");if("string"!=typeof e)throw new Error("invalid template");if(!s)throw new Error("localStorage not available");i(this,{trackers:{get:function(){return n}},minified:{get:function(){return Object.keys(n).reduce(function(t,e){return t.concat([n[e].minified])},[])}},mergeMode:{get:function(){return/(^|\ )trackers-merge-mode(\ |$)/i.test(t.wrap.className)}},deleteMode:{get:function(){return/(^|\ )trackers-delete-mode(\ |$)/i.test(t.wrap.className)}}}),this.add=function(i,o){var s,u=r++;return o="boolean"==typeof o?o:!0,i=n[u]=i instanceof a?i:new a,s=c(e,{tracked:i.format(),description:i.description,tracking:i.tracking,id:u}),t.list.insertBefore(s,t.list.firstChild),this.addTrackerEvents(i,{container:s,tracked:s.querySelector(".tracker-tracked"),description:s.querySelector(".tracker-description"),toggle:s.querySelector(".tracker-toggle")}),o&&this.store(),this},this.remove=function(e,r){return r="boolean"==typeof r?r:!0,n.hasOwnProperty(e)&&(delete n[e],t.list.removeChild(document.getElementById("tracker-"+e)),r&&this.store()),this},this.enableMergeMode=function(){this.disableDeleteMode(),t.wrap.className+=" trackers-merge-mode"},this.disableMergeMode=function(){t.wrap.className=t.wrap.className.replace(/(^|\ )trackers-merge-mode(\ |$)/gi,"$2")},this.enableDeleteMode=function(){this.disableMergeMode(),t.wrap.className+=" trackers-delete-mode"},this.disableDeleteMode=function(){t.wrap.className=t.wrap.className.replace(/(^|\ )trackers-delete-mode(\ |$)/gi,"$2")},t.add.addEventListener("click",function(){var t=r;this.add(),n[t].start(),document.getElementById("tracker-"+t).querySelector(".tracker-description").focus()}.bind(this)),t.merge.addEventListener("click",function(){this.toggleMergeMode()}.bind(this)),t["delete"].addEventListener("click",function(){this.toggleDeleteMode()}.bind(this))}var i=t("functions/define-properties"),o=t("functions/on-value-update"),c=t("functions/render-template"),a=t("classes/tracker"),s=window.localStorage;n.prototype.store=function(){try{s.setItem("trackers",JSON.stringify(this.minified))}catch(t){throw new Error("could not store trackers")}},n.prototype.restore=function(){try{Object.keys(this.trackers).forEach(function(t){this.remove(t)}.bind(this)),(JSON.parse(s.getItem("trackers"))||[]).forEach(function(t){t.unshift(null),this.add(new(Function.prototype.bind.apply(a,t)),!1)}.bind(this))}catch(t){throw new Error("could not restore trackers")}},n.prototype.toggleMergeMode=function(){this.mergeMode?this.disableMergeMode():this.enableMergeMode()},n.prototype.toggleDeleteMode=function(){this.deleteMode?this.disableDeleteMode():this.enableDeleteMode()},n.prototype.addTrackerEvents=function(t,e){function r(){e.container.className=e.container.className.replace(/(^|\ )tracker--(not-)?tracking(\ |$)/gi,"$3")}function n(){s&&clearInterval(s),s=window.setInterval(function(){e.tracked!==document.activeElement&&(e.tracked.value=t.format())})}function i(){clearInterval(s)}function c(){e.description.style.height="auto",e.description.style.height=e.description.scrollHeight+"px"}var s;o(e.description,function(){t.description=e.description.value,c(),this.store()}.bind(this)),o(e.tracked,function(){t.tracked=a.stringToDuration(e.tracked.value),t.tracking&&(t.trackingSince=a.now()),this.store()}.bind(this)),e.tracked.addEventListener("blur",function(){e.tracked.value=t.format()}),e.toggle.addEventListener("click",function(){t.toggle(),this.store()}.bind(this)),t.on("start",function(){Object.keys(this.trackers).forEach(function(e){this.trackers[e]!==t&&this.trackers[e].stop()}.bind(this)),n(),r(),c()}.bind(this)),t.on("stop",function(){i(),r(),c()}),t.tracking&&n(),c()},e.exports=n},{"classes/tracker":2,"functions/define-properties":3,"functions/on-value-update":5,"functions/render-template":6}],2:[function(t,e,r){"use strict";function n(t,e,r){var o={tracked:0,tracking:!1,description:""},c={};i(this,{tracked:{get:function(){return o.tracked},set:function(t){"undefined"!=typeof t&&(o.tracked=n.durationToNumber(n.anyToDuration(t)))}},trackedTotal:{get:function(){return this.tracking?o.tracked+n.now()-o.tracking:this.tracked}},tracking:{get:function(){return o.tracking!==!1},set:function(t){"boolean"==typeof t?(o.tracked=this.trackedTotal,t?o.tracking=n.now():o.tracking=!1):"undefined"!=typeof t&&(o.tracking=n.now()-n.durationToNumber(n.anyToDuration()))}},trackingSince:{get:function(){return this.tracking?o.tracking:void 0},set:function(t){"undefined"!=typeof t&&(t=parseInt(t,10),isNaN(t)||(o.tracking=t))}},description:{get:function(){return o.description},set:function(t){"string"==typeof t&&(t=t.trim()).length>0&&(o.description=t)}},minified:{get:function(){return[o.tracked,o.tracking,o.description]}}}),this.merge=function(t){return t instanceof n&&(o.tracked+=n.durationToNumber(t.trackedTotal),o.description+="\n"+t.descroption),this},this.on=function(t,e){"function"==typeof e&&(c[t]=e)},this.trigger=function(t){c.hasOwnProperty(t)&&c[t]()},this.tracked=t,this.trackingSince=e,this.description=r}var i=t("functions/define-properties");n.prototype.start=function(){return this.tracking=!0,this.trigger("start"),this},n.prototype.stop=function(){return this.tracking=!1,this.trigger("stop"),this},n.prototype.toggle=function(){this.tracking?this.stop():this.start()},n.prototype.format=function(t,e){return t="string"==typeof t?t:"%h:%m:%s",e="undefined"!=typeof e?n.anyToDuration(e):n.numberToDuration(this.trackedTotal),Object.keys(e).reverse().reduce(function(t,r){return t.replace(new RegExp("%"+r,"ig"),("0"+e[r]).slice(-2))},t)},n.now=function(){return(new Date).getTime()},n.numberToDuration=function(t){return{h:Math.floor(t/36e5),m:Math.floor(t/6e4%60),s:Math.floor(t/1e3%60),ms:Math.floor(t%1e3)}},n.stringToDuration=function(t){return n.arrayToDuration(("string"==typeof t?t:t.toString()||"").replace(/[^0-9:]/g,"").split(":"))},n.arrayToDuration=function(t){return["h","m","s","ms"].reduce(function(e,r,n){var i=parseInt(t[n],10);return e[r]=isNaN(i)?0:i,e},{})},n.durationToNumber=function(t){var e=0;return t.hasOwnProperty("h")&&(e+=60*parseInt(t.h,10)*60*1e3),t.hasOwnProperty("m")&&(e+=60*parseInt(t.m,10)*1e3),t.hasOwnProperty("s")&&(e+=1e3*parseInt(t.s,10)),t.hasOwnProperty("ms")&&(e+=parseInt(t.ms,10)),e},n.anyToDuration=function(t){if("number"==typeof t&&!isNaN(t))return n.numberToDuration(t);if(Array.isArray(t))return n.arrayToDuration(t);if("string"==typeof t)return n.stringToDuration(t);if("object"==typeof t)return n.numberToDuration(n.durationToNumber(t));throw new Error("unexpected duration type: "+typeof t)},e.exports=n},{"functions/define-properties":3}],3:[function(t,e,r){"use strict";function n(t,e,r){if("object"!=typeof t)throw new Error("no valid object to add properties");if("object"!=typeof e)throw new Error("no valid definitions object");r="object"==typeof r?r:{get:i,set:i,enumerable:!0},Object.defineProperties(t,Object.keys(e).reduce(function(t,n){return t[n]=Object.keys(r).reduce(function(t,e){return t.hasOwnProperty(e)||(t[e]=r[e]),t},e[n]),t},{}))}function i(){}e.exports=n,e.exports.noop=i},{}],4:[function(t,e,r){"use strict";function n(t){"loading"!==document.readyState?t():document.addEventListener("DOMContentLoaded",t)}e.exports=n},{}],5:[function(t,e,r){"use strict";function n(t,e){function r(t){window.setTimeout(function(){e(t)},0)}t.addEventListener("change",e),t.addEventListener("cut",r),t.addEventListener("paste",r),t.addEventListener("drop",r),t.addEventListener("keydown",r)}e.exports=n},{}],6:[function(t,e,r){"use strict";function n(t,e){var r=document.implementation.createHTMLDocument(),n=i[t]=i[t]||new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("{%").join("	").replace(/((^|%\})[^\t]*)"/g,"$1\r").replace(/\t=(.*?)%\}/g,"',$1,'").split("	").join("');").split("%}").join("p.push('").split("\r").join('"')+'\');}return p.join("");');return e="object"==typeof e?e:{},r.body.innerHTML=n(e),r.body.children.length>1?r.body.children:r.body.children[0]}var i={};e.exports=n},{}],7:[function(t,e,r){"use strict";var n,i=t("functions/on-dom-ready"),o=t("classes/tracker-collection");i(function(){n=new o({wrap:document.getElementById("trackers-wrap"),list:document.getElementById("trackers-list"),add:document.getElementById("trackers-button--add"),merge:document.getElementById("trackers-button--merge"),"delete":document.getElementById("trackers-button--delete")},document.getElementById("tracker-template").innerHTML),n.restore()})},{"classes/tracker-collection":1,"functions/on-dom-ready":4}]},{},[7]);
//# sourceMappingURL=main.js.map